#!/usr/bin/env python

import subprocess
import sys
import os
import re
from datetime import datetime, timedelta

if len(sys.argv) > 1:
  yearmonth = sys.argv[1]
  if yearmonth == 'prevmonth':
    now = datetime.now()
    yearmonth = (now - timedelta(days=now.day)).strftime('%Y%m')
  year, month = re.search(r'^(\d{4})(\d{2})$', yearmonth).groups()
  dirtemplate = os.path.join('/var/www/awstats/archive/%s', yearmonth)
  additional_params = ['-month=%s' % month, '-year=%s' % year]
else:
  dirtemplate = '/var/www/awstats/%s'
  additional_params = []
