location <%= @location_base %>/
{

  location <%= @location_base %>/subjects
  {
    if ($arg_q = "")
    {
      return 403;
    }

    if ($arg_limit = "")
    {
      return 403;
    }
  }

  fastcgi_pass unix:/tmp/<%= @name %>-fastcgi.sock;
  fastcgi_split_path_info ^(<%= @location_base %>)(.*)$;
  include /etc/nginx/fastcgi_params;
  fastcgi_param SCRIPT_NAME $fastcgi_script_name;
  fastcgi_param PATH_INFO $fastcgi_path_info;
  client_max_body_size 20m;
}

location <%= @location_base %>/chrome/
{
  alias /home/trac/htdocs-<%= @name %>/htdocs/;
}

location <%= @location_base %>/robots.txt
{
  alias /home/trac/robots.txt;
}

# http://hub.eyeo.com/issues/14860
rewrite /about/?$ https://adblockplus.org/privacy redirect;
sub_filter "Powered by" "";
sub_filter "Trac 1.0.1" "Privacy Policy";
